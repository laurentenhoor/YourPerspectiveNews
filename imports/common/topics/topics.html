<div  id="scroll-{{topic._id}}" class="scroll-window" scroll-disabler ng-repeat="topic in $ctrl.topics | orderBy:'-createdAt'"
 ng-init="topic.selectedArticle = {}">

	<div class="scroll-container">

		<topic-controls topic-id="topic._id"></topic-controls>
		<!-- <topic-summary></topic-summary> -->

		<div class="content-container" ng-repeat="categoryBlock in topic.articlesByCategory | orderBy:'sortingOrder'" ng-show="articles.length>0"
		 ng-init="
			categoryName=categoryBlock.category; 
			articles=$ctrl.getArticlesByIds(categoryBlock.articleIds);
			topic.selectedArticle[categoryName]=$ctrl.getArticleWithHighestScore(articles);
			$ctrl.loadedArticles= $ctrl.loadedArticles.concat(categoryBlock.articleIds);
			">

			<!-- <topic-item></topic-item> -->

			<div class="bulletin-item-header">{{categoryName}}</div>

			<div class="bulletin-item-image-and-details-container">

				<div class="bulletin-item-image-container">

					<div class="bulletin-item-controls-container">

						<div class="bulletin-voting" ng-init="" ng-if="true">

							<div ng-click="$ctrl.vote(topic.selectedArticle[categoryName],1)" class="bulletin-arrow-up" ng-class="{true: 'bulletin-upvoted', false: ''}[$ctrl.userVoteMap[topic.selectedArticle[categoryName]._id]==1]">
							</div>

							<div class="bulletin-vote-score">
								{{$ctrl.articlesScoreMap[topic.selectedArticle[categoryName]._id] || 0}}
							</div>

							<div ng-click="$ctrl.vote(topic.selectedArticle[categoryName],-1)" class="bulletin-arrow-down" ng-class="{true: 'bulletin-downvoted', false: ''}[$ctrl.userVoteMap[topic.selectedArticle[categoryName]._id]==-1]">
							</div>

						</div>
					</div>

					<div class="bulletin-item-image" ng-style="{'background-image':'url(\'' + (topic.selectedArticle[categoryName].imageUrl) + '\')'}"
					 style="background-color:{{ topic.selectedArticle[categoryName].videoUrl ? 'black' : 'rgb(187, 187, 187)' }}">
					</div>

					<iframe class="bulletin-video-player-iframe" ng-if="topic.selectedArticle[categoryName].videoUrl" src="{{topic.selectedArticle[categoryName].videoUrl}}"
					 allowfullscreen>
					</iframe>

					<div class="solid-overlay">
					</div>

					<div ng-click="$ctrl.openExternalUrl(topic.selectedArticle[categoryName]);" ng-class="topic.selectedArticle[categoryName].videoUrl ? 'link-disabled' : ''"
					 ng-hide="topic.selectedArticle[categoryName].videoUrl">

						<div class="bulletin-item-title-container">

							<div class="bulletin-item-title" ng-class="{'bulletin-visited' : (topic.selectedArticle[categoryName]._id == $ctrl.visitedId)}">
								{{topic.selectedArticle[categoryName].title}}
							</div>

							<div class="bulletin-item-publisher">
								{{topic.selectedArticle[categoryName].publisher}}
							</div>

							<div class="bulletin-time-elapsed">
								{{ $ctrl.getTimeTag(topic.selectedArticle[categoryName]) }}
							</div>

						</div>
					</div>

				</div>

				<!-- 			<a href="{{topic.selectedArticle[categoryName].url || ''}}"  -->
				<!-- 				target="_self"  -->
				<!-- 				class="{{topic.selectedArticle[categoryName].videoUrl ? 'link-disabled' : ''}}"> -->
				<div class="bulletin-item-description" ng-if="topic.selectedArticle[categoryName].description" ng-click="toggle = !toggle"
				 ng-class="{'auto-height' : toggle}">
					{{topic.selectedArticle[categoryName].description}}
				</div>
				<!-- 			</a> -->

				<div class="bulletin-sources">

					<article-actions-button topic-id="topic._id" category="categoryBlock" article="topic.selectedArticle[categoryName]" class="edit-article-from-topics">
					</article-actions-button>

					<div class="bulletin-source" ng-repeat="article in articles | orderBy:'-score'" ng-click="$ctrl.clickArticle(topic, categoryName, article)"
					 ng-class="(article._id == topic.selectedArticle[categoryName]._id) ? 'bulletin-source-selected':''" ng-style="{'background-image':'url(\'' + (article.logoUrl) + '\')'}">
					</div>
				</div>

			</div>

		</div>

		<!-- <opinion-tile topic-id="topic._id">
		</opinion-tile> -->

		<comments-tile topic-id="topic._id">
		</comments-tile>

	</div>

</div>