<div class="content-container">

    <div class="tile-header">&nbsp;
        <hotness-indicator item-id="$ctrl.topic._id"></hotness-indicator>
        <!-- <div class="summary-temperature">Temp: {{ $ctrl.topic.stats.hotness | number: 2}}</div> -->
    </div>

    <div
        class="tile-container"
        ng-style="{'background-image': $ctrl.questions.length === 0 ? '' : 'linear-gradient(to top, rgba(236,233,230,0.36), #fff)' }"
    >
        <div class="tile-overlay"></div>

        <div
            class="first-use-text"
            ng-show="$ctrl.questions.length==0"
        >
            Stel een vraag en zoek een expert!
        </div>
        <questions>
            <question
                ng-repeat="question in $ctrl.questions"
                ng-init="answers = $ctrl.answers(question._id);
                    showAmountOfAnswers = Infinite;"
            >
                <content>

                    <div>
                        <div
                            ng-show="$ctrl.userId==question.ownerId"
                            ng-click="$ctrl.deleteById(question._id)"
                            class="remove"
                        >
                            <md-icon>delete</md-icon>
                        </div>
                        <div class="question">{{question.question}}</div>

                        <div class="question-timestamp">
                            {{ question.createdAt | timeFromNow }} gevraagd door {{ $ctrl.user(question.ownerId) | usernameFilter }}
                        </div>
                        <div class="question-controls">

                            <div
                                ng-if="showAnswerInput"
                                style="padding:0 2.1vw;"
                            >
                                <div class="new-question-title">Antwoord</div>
                                <md-input-container
                                    class="md-block"
                                    md-no-float
                                    style="margin:0;"
                                >
                                    <textarea
                                        ng-model="question.answer"
                                        rows="auto"
                                        md-select-on-focus
                                        placeholder="Geef jouw antwoord."
                                    ></textarea>

                                </md-input-container>
                            </div>
                            <md-button
                                ng-show="showAnswerInput"
                                ng-click="$ctrl.saveAnswer(question, question.answer, showAnswerInput);showAnswerInput=!showAnswerInput;showAmountOfAnswers=Infinity;"
                            >
                                Stuur antwoord
                            </md-button>
                            <md-button
                                ng-show="showAnswerInput"
                                ng-click="showAnswerInput=!showAnswerInput"
                            >
                                Annuleren
                            </md-button>
                            <md-button
                                ng-show="!showAnswerInput"
                                ng-click="showAnswerInput=!showAnswerInput"
                            >
                                Beantwoord
                            </md-button>
                            <md-button ng-show="!showAnswerInput">Expert aandragen</md-button>
                        </div>
                    </div>

                    <div
                        ng-repeat="answer in answers | limitTo: showAmountOfAnswers"
                        ng-init="user = $ctrl.user(answer.ownerId)"
                        class="answer-container"
                    >
                        <div
                            ng-show="$ctrl.userId==answer.ownerId"
                            ng-click="$ctrl.deleteById(answer._id)"
                            class="remove"
                        >
                            <md-icon>delete</md-icon>
                        </div>

                        <contact-info>
                            <div class="avatar">
                                <img
                                    ng-src="https://media.licdn.com/mpr/mprx/0_mK4hvDqgUK1olFIumNm8gejy0L6nc5F2C3uh1JogRi7cczbDC38aYJ-g4KsIqFz2INuaRJlj-N5BN3QrkijpgJpABN59N3iuCijin4dpyvKsYc4ratwS9uFDc3x6j3NgI8M2A6LsD0E"
                                    class="avatar-img"
                                    alt="{{item.who}}"
                                >
                            </div>

                            <contact-details>
                                <div class="name">{{ user |  usernameFilter }}</div>
                                <div class="headline">{{ user |  headlineFilter }}</div>
                                <div class="timestamp">
                                    {{ answer.createdAt | timeFromNow }} beantwoord
                                </div>
                            </contact-details>
                        </contact-info>

                        <div class="answer">{{ answer.answer }}</div>

                    </div>
                </content>

            </question>
        </questions>
        <div class="new-question">

            <div
                ng-if="showQuestionInput || $ctrl.questions.length==0"
                style="padding:0 2.1vw;"
            >
                <div class="new-question-title">
                        Open vragen beginnen met 'wie', 'wat', 'wanneer', 'hoe', 'waar' of 'waarom'...
                </div>
                <md-input-container
                    class="md-block"
                    md-no-float
                    style="margin:0;"
                >
                    <textarea
                        ng-model="$ctrl.newQuestion"
                        md-maxlength="200"
                        rows="auto"
                        md-select-on-focus
                        placeholder="Stel jouw vraag"
                    ></textarea>
                </md-input-container>
            </div>

            <md-button
                ng-show="!showQuestionInput"
                ng-hide="$ctrl.questions.length==0"
                ng-click="showQuestionInput=true"
            >
                Stel een nieuwe open vraag
            </md-button>
            <md-button
                ng-show="showQuestionInput || $ctrl.questions.length==0"
                ng-click="$ctrl.saveQuestion();showQuestionInput=false"
            >
                Vraag Insturen
            </md-button>
            <md-button
                ng-show="showQuestionInput && !$ctrl.questions.length==0"
                ng-click="showQuestionInput=false"
            >
                Annuleren
            </md-button>
        </div>

    </div>
</div>
